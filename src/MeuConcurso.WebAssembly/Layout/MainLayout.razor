@inherits LayoutComponentBase

@inject NavigationManager NavigationManager
@inject LayoutStateService LayoutStateService

@implements IDisposable

<DefaultTheme />
<MudPopoverProvider />
<MudDialogProvider />
<MudSnackbarProvider />

<MudLayout Style="width: 22.5rem; height: 31.25rem; display: flex; flex-direction: column;">
    <AppBar @bind-LayoutType="LayoutStateService.LayoutType" @bind-PageName="LayoutStateService.PageName" />
        <MudMainContent Class="pt-18 px-6" style="flex: 1; overflow: auto;">
            @Body        
        </MudMainContent>
    <MudStack Row AlignItems="AlignItems.Center" Justify="Justify.SpaceAround" Style="width: 100%;">
        <MudIconButton Icon="@Icons.Material.Filled.Home" OnClick="@(() => NavigationManager.NavigateTo("popup.html"))"/>
        <MudIconButton Icon="@Icons.Material.Filled.Settings" OnClick="@(() => NavigationManager.NavigateTo("preferences.html"))" />
        <MudIconButton Icon="@Icons.Material.Filled.Info" />
    </MudStack>
</MudLayout>

@code {
    protected override void OnInitialized()
    {
        LayoutStateService.LayoutChanged += UpdateLayout;
    }

    private void UpdateLayout()
    {
        InvokeAsync(StateHasChanged);
    }    

    public void Dispose()
    {
        LayoutStateService.LayoutChanged -= UpdateLayout;
    }
}